/* ===== Mobile Portrait (<=640px) — overrides only ===== */
/* Link with: media="(max-width: 640px) and (orientation: portrait)" */

/* Жёсткая посадка экрана на iOS/Chrome(iOS) в этом режиме */
html, body{
  height:100%;
  overflow:hidden;
  overscroll-behavior:none;
  -webkit-text-size-adjust:100%;
}

#screen-app{
  grid-template-columns:1fr;
  grid-template-rows:auto minmax(0,1fr) auto;
  grid-template-areas:
    "sidebar"
    "stage"
    "footer";
  height:100dvh;
  min-height:100dvh;
  max-height:100dvh;
  overflow:hidden;
  padding-bottom:env(safe-area-inset-bottom);
}
@supports not (height:100dvh){
  #screen-app{ height:calc(var(--vh, 1vh) * 100); }
}

.sidebar{grid-area:sidebar}
.stage{grid-area:stage; padding-top:0; min-height:0; overflow:hidden}
.topbar{padding:0; padding-bottom:10px; padding-left:10px}

/* Онлайн-список */
#onlineList{
  display:grid;
  grid-template-columns:repeat(2, minmax(0, 1fr));
  gap:8px;
}
.user{
  padding:8px;
  border:1px solid var(--line);
  background:var(--panel);
  border-radius:12px;
  gap:8px;
}
.user:hover{background:rgba(255,255,255,.03)}

.tile .name{top:10px; bottom:unset}

/* === Tiles-контейнеры =================================================== */

/* Корневой контейнер плиток — обычный блок (раньше была «лента») */
.tiles{
  display:block !important;           /* не grid и не flex — не мешаем абсолютам детей */
}

/* Рабочая область плиток. Её позиционирует мозаика (JS). */
.tiles-main{
  position:relative;                   /* база для absolute-детей */
  min-height:0;
  overflow:hidden;                     /* горизонталь нам не нужна в мозаике */
  -webkit-overflow-scrolling:auto;
  overscroll-behavior:contain;
  touch-action:auto;
  /* ВАЖНО: никаких display:grid/flex — иначе могут быть побочки.
     Если где-то остался старый стиль, перекрываем: */
  display:block;
  gap:0;                               /* gap grid-а не нужен абсолютам */
}

/* Фолбэк для тайла до прихода JS (чтобы не было белого экрана).
   После расчёта мозаика задаёт width/height/left/top инлайнами. */
.tile{
  min-height:0;
  flex:none;
  width:100%;
  height:auto;
  aspect-ratio:16 / 9;                 /* временно; JS снимет и проставит размеры */
  scroll-snap-align:unset;
}
.tile .controls{display:none !important}
<<<<<<< HEAD
/* Видео заполняет тайл как и иконки: меньшая сторона совпадает */
.tile video{
  width:100%;
  height:100%;
  display:block;
  object-fit:cover;         /* <-- ключевая правка */
  object-position:center;
}

=======
.tile video{width:100%; height:100%; object-fit:cover; object-position:center}
>>>>>>> parent of f7235b8 (0.84)

/* Кастомный скроллбар плиток — в портретной мозаике скрыт */
.tiles-sbar{ display:none !important }

/* ===== Footer as swipe carousel (портрет: 3 панели) ====================== */
.footer{
  grid-area:footer;
  display:block;
  padding-bottom:env(safe-area-inset-bottom);
  min-width:0;
}

.foot-swipe{
  display:flex;
  width:100%;
  min-width:0;
  height:var(--footer-h, 260px);
  overflow-x:auto; overflow-y:hidden;
  scroll-snap-type:x mandatory;
  -webkit-overflow-scrolling:touch;
  scrollbar-width:none; -ms-overflow-style:none;
  overscroll-behavior:contain;
  touch-action:pan-x;
  gap:0;
  scroll-padding-inline:0;
  box-sizing:border-box;
  padding-left: env(safe-area-inset-left);
  padding-right: env(safe-area-inset-right);
}
.foot-swipe::-webkit-scrollbar{display:none}

.foot-pane{
  flex:0 0 100%;
  width:auto;
  min-width:0;
  height:100%;
  box-sizing:border-box;
  padding:12px 12px 0 12px;

  scroll-snap-align:start;
  scroll-snap-stop:always;

  overflow-y:hidden;
  overscroll-behavior-y:none;
}

/* Опционально: порядок, если DOM не переставлен JS-ом */
.foot-pane.pane-connected{ order:1; }
.foot-pane.pane-settings { order:2; }
.foot-pane.pane-chat     { order:3; }

.foot-pane:last-child{border-right:none}
.footer-left{padding:0; border-right:none}
.footer-right{padding:0}
.chatbox{margin:0; height:100%}
.chat-log{min-height:135px;}
#btnShare{display:none !important}

/* Пейджер */
.foot-dots{
  display:flex; justify-content:center; align-items:center;
  gap:10px; padding:5px;
}
.foot-dots .fdot{
  width:12px; height:16px; border-radius:50%;
  background:transparent; border:2px solid var(--dots);
  opacity:.85; transform:scale(.95);
  transition:transform .18s ease, opacity .18s ease, background .18s ease, border-color .18s ease;
}
.foot-dots .fdot.active{
  background:var(--dots); border-color:var(--dots);
  opacity:1; transform:scale(1.1);
}
.foot-dots .fdot:focus-visible{
  outline:2px solid rgba(255,255,255,.6); outline-offset:2px;
}
/* Мозаика: размеры задаёт JS через CSS-переменные */
.tiles-main.mosaic-active .tile{
  position:absolute;                /* на всякий случай, если где-то переопределили */
  width: var(--mw) !important;      /* размеры, проставленные из JS */
  height: var(--mh) !important;
  box-sizing: border-box;           /* чтобы рамки/паддинги не раздували тайл */
}

/* Унификация: чтобы "моя" плитка не была больше из-за рамки/паддингов */
.tile{ box-sizing:border-box; }
/* если у .tile.me где-то толще border — выровняйте: */
.tile.me{ border-width:1px; padding:0; }  /* по необходимости; без width/height! */
/* Иконки/превью тоже заполняют контейнер */
.tile img{
  width:100%;
  height:100%;
  display:block;
  object-fit:cover;
  object-position:center;
}
